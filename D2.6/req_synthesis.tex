% Requirements for openETCS --- WP2
% Author: Sylvain Baro (SNCF)
% Version 1.1.0


\documentclass{template/openetcs_article}
% Use the option "nocc" if the document is not licensed under Creative Commons
%\documentclass[nocc]{template/openetcs_article} 
\usepackage{rotating,url,color}
\graphicspath{{./template/}{.}{./images/}}
\begin{document}
\frontmatter
\project{openETCS}

%Please do not change anything above this line
%============================
% The document metadata is defined below

%assign a report number here
\reportnum{OETCS/WP2/D2.6~--~1.1.0}

%define your workpackage here
\wp{Work-Package 2: ``Requirements''}

%set a title here
\title{Requirements for openETCS}

%set a subtitle here
%\subtitle{A template for short document. Adapted from report template.}

%set the date of the report here
\date{April 2013}

%define a list of authors and their affiliation here

\author{Sylvain Baro}
\affiliation{SNCF}
\author{Jan Welte}
\affiliation{TU-BS}  
  
% define the coverart
\coverart[width=350pt]{chart}

%define the type of report
\reporttype{Requirements}


%
% End of QA Zone
\begin{abstract}
This document provides the list of higher level requirements for the openETCS project. 
\end{abstract}

%=============================
%Do not change the next three lines
\maketitle

% 
% QA zone

\begin{tabular}{|p{4.4cm}|p{8.7cm}|}
\hline
\multicolumn{2}{|c|}{Document information} \\
\hline
Work Package &  WP2  \\
Deliverable ID or doc. ref. & D2.6\\
\hline
Document title & Requirements for openETCS \\
Document version & 1.1.0 \\
Document authors (org.)  & Sylvain Baro (SNCF) \\
\hline
\end{tabular}

\begin{tabular}{|p{4.4cm}|p{8.7cm}|}
\hline
\multicolumn{2}{|c|}{Review information} \\
\hline
Last version reviewed & 0.1.0 \\
\hline
Main reviewers & St\'ephane Callet, Cyril Cornu, David Mentre, Marielle Petit-Doche, Stanislas Pinte, Merlin Pokam, Guillaume Pottier, Uwe Steinke\\
\hline
\end{tabular}

\begin{tabular}{|p{2.2cm}|p{4cm}|p{4cm}|p{2cm}|}
\hline
\multicolumn{4}{|c|}{Approbation} \\
\hline
  &  Name & Role & Date   \\
\hline  
Written by    &  Sylvain Baro &   & \\
\hline
Approved by & Gilles Dalmas & WP2 leader & \\
\hline
\end{tabular}

\begin{tabular}{|p{2.2cm}|p{2cm}|p{3cm}|p{5cm}|}
\hline
\multicolumn{4}{|c|}{Document evolution} \\
\hline
Version &  Date & Author(s) & Justification  \\
\hline  
0.0.0 & 01/01/13 & S. Baro &  Document creation  \\
\hline  
0.1.0 & 15/01/13 & S. Baro &  Request for comment to some partners, version for review  \\
\hline  
1.0.0 & 05/03/13 & S. Baro &  Version after first review. Req. version is 1. \\
\hline
1.1.0 & 19/04/13 & S.~Baro, J.~Welte &  Update after workshop on safety and tools. Updated req. version is X.\\
\hline
\end{tabular}

\newpage

\tableofcontents
%\listoffiguresandtables
\newpage





%=============================
% The actual document starts below this line
%=============================


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%              My macros (=> Sylvain Baro)               %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\docend}{{\begin{center}\large\textbf{<End of Document>}\end{center}}}
\newcommand{\tbd}{\colorbox{cyan}{\%\%To Be Defined\%\%}}
\newcommand{\tbc}{\colorbox{cyan}{\%\%To Be Confirmed\%\%}}
\newcommand{\todo}[1]{\colorbox{cyan}{\%\%{#1}\%\%}}
\newlength{\origindent}

\newenvironment{issue}{
	\begin{quote}
	\begin{itshape}Open Issue. 
}{
	\end{itshape}
	\end{quote}
}

\newenvironment{comment}{
	\begin{quote}
	\begin{itshape}Comment. 
}{
	\end{itshape}
	\end{quote}
}

\newenvironment{justif}{
	\begin{quote}
	\begin{itshape}Justification. 
}{
	\end{itshape}
	\end{quote}
}
\input{req}

\def\reqt{R-WP2/D2.6}
% Start here


\section{Introduction}
The purpose of this document is to enumerate the meta-requirements of the projects: \emph{i.e.} 
the requirements on the modelling, processes, toolchain, validation and verification. 
The purpose of this document is 
not to provide the system and safety requirements that will specify the model/software 
developed in the OpenETCS project.

The requirements found in the CENELEC standards as well as those found in the ERTMS specifications
are not rewritten here. The required plans for the 
project shall be written according to what is required in the standards (see Sect.~\ref{standards}),
then reviewed. Once this task is done, the plans will be the reference for the project.
In the meantime, one can refer to the standards, or to the D2.2 document.

This document was initiated as a preliminary requirement list, and is now evolving during the project 
to be completed with all the requirements on the methodology
modelling, process, tool chain, and safety proof.

\section{Reference documents}
\subsection{Standards \& ERA documents}
\label{standards}
\begin{itemize}
\item CENELEC EN 50126-1 --- 01/2000 --- \emph{Railways applications –- The specification and 
demonstration of Reliability, Availability, Maintenability and Safety (RAMS) –- Part 1: 
Basic requirements and generic process}
\item CENELEC EN 50128 --- 10/2011 --- \emph{Railway applications -- Communication, signalling and 
processing systems -- Software for railway control and protection systems}
\item CENELEC EN 50129 --- 05/2003 --- \emph{Railway applications –- Communication, signalling and 
processing systems –- Safety related electronic systems for signalling}
\item CCS TSI --- \emph{ CCS TSI for HS and CR transeuropean rail has been adopted by a Commission Decision 2012/88/EU on the 25th January 2012}
\item SUBSET-026 3.3.0 --- \emph{System Requirement Specification}
\item SUBSET-076-x 2.3.y --- Test related ERTMS documentation
\item SUBSET-088 2.3.0 --- \emph{ETCS Application Levels 1 \& 2 - Safety Analysis}
\item SUBSET-091 3.2.0 --- \emph{Safety Requirements for the Technical Interoperability
of ETCS in Levels 1 \& 2}
\end{itemize}
\subsection{Project documents}
\begin{itemize}
\item FPP --- \emph{Project Outline Full Project Proposal Annex OpenETCS} -- v2.2
\item D2.1 --- \emph{Report on existing methodologies} --- Jan Welte and Hansj\"org Manz
\item D2.2 --- \emph{Report on CENELEC standards} --- Merlin Pokam and Norbert Sch\"afer
\end{itemize}

\section{Conventions}
The requirements are prefixed by “R-zz-x-y”, and are written in a roman typeface, where ``R'' 
stands for ``Requirement'', ``zz'' identifies the source document,``x'' 
is the version number and``y'' is the identifier of the requirement. All the text 
written in italics is not a requirement: it may be a note, an open issue, an 
explanation of the requirements, or an example.

The placeholder “\todo{xxx}” is used to indicates that a paragraph or section is not finished, 
to be defined or to be confirmed.

\section{Glossary}
\begin{description}
\item[API] Application Programming Interface
\item[FFM] Fully-Formal Model
\item[FME(C)A] Failure Mode Effect (and Criticity) Analysis
\item[I/O] Input/Output
\item[OBU] OnBoard Unit
\item[QA] Quality Assurance
\item[RBC] Radio Block Center
\item[RTM] RunTime Model
\item[SIL] Safety Integrity Level
\item[SFM] Semi-Formal Model
\item[SRS] System Requirement Specification (in this document, this is equivalent to the SUBSET-026 of the TSI)
\item[SSRS] SubSystem Requirement Specification
\item[THR] Tolerable Hazard Rate
\item[V\&V] Verification \& Validation
\end{description}

\section{Goals}
The following goals for the projects were considered for the writing of this document. Please note that 
they are \emph{not} listed by order of priority, but in an arbitrary order.

\subsection{Goal 1: Formalization of the SRS into a high level, executable, semi-formal and formal model}
The first goal of the project is to propose a formalization of a subset of the on-board subsystem,
as defined in the SUBSET-026, for the chosen reference baseline. 

The purpose of the formalization is:
\begin{itemize}
\item to enhance the understanding of modelled subset;
\item to allow formal analysis of the modelled subset;
\item to be able to animate the model for testing and analyzing purpose;
\item to provide information on the completeness and soundness of the SUBSET-026;
\item to be used as a reference formal specification for the implementation of an OBU 
(by the OpenETCS project team and by industrial actors);
\item \dots
\end{itemize}

In order to conduct this formalization, a part of the tool chain and methodology defined (see Goal 2) 
will be used.

There will be two models created to satisfy this goal. One semi-formal executable (but not in real time)
model, for which we aim to model all the requirements considered in the scope by the system design, covering as
much features as possible of the Onboard Unit.

On some parts of the system, this model will be completed with a strictly formal model. This will allow to improve
the understanding of the system, and will provide elements for verification and validation using formal proof. 

This will also allow to demonstrate the feasibility of the process using both semi-formal and formal modelization 
and the capabilities of analysis on the formal model using formal methods. 

\subsection{Goal 2: Definition of process/methodologies required for the safety validation
of the model}

The full safety process needed for the OpenETCS to be \emph{certifiable} according to the CENELEC standards
shall be described. The safety plan and safety case concept will detail precisely which activities 
are required or not with regard to the scope and the context of the project.

The process has in particular to ensure that toolchain, formalized SUBSET-026 specification and models are certifiable 
according to these standards while emerging from an open source environment. 

\subsection{Goal 3: Apply the safety activities on a subset of the project}
Because the full design, development, validation and safety analysis process for a SIL4 OBU
is a huge task far beyond the project possibilities, the full safety activities will not be conducted
on the whole subsystem. 

The safety analyses as described in the safety plan and safety case concept shall be conducted on a selected 
subset of the system, and on a selected subset of safety properties. It will start with system-level safety 
activities, then go down into the semi-formal, then formal model.


\subsection{Goal 4: Definition of a tool chain for developing on onboard software that can fulfill the EN 50128 
requirements}
These tools must be \emph{qualified} according to the corresponding tool level of EN 50128 (considering the 
process for which they are used), but will not be certified as part of the project.

By the combination of Goal 1, 2 and 3, it should be possible for the industry to build an ETCS 
onboard software:
\begin{itemize}
\item By using OpenETCS model\,\footnote{Or \emph{models} if several models are developed. In order to enhance readability,
I will use the singular even if it could cover a semi-formal model and a formal model.} and proving the implementation satisfies 
the model;
\item By using the OpenETCS toolchain with their own model;
\item By using the OpenETCS model and toolchain.
\end{itemize}

\subsection{Goal 5: Building a non Vital executable demonstrator/simulator of the model}
From the model, an executable software will be derived. This software will be used for simulation and 
demonstration. This software will be completely non Vital. It will be able to execute in real time and to 
interface with other components. 

\section{Project outline}
In order to pursue these goals, the development cycle for the project may be presented as follow. 

\textbf{Please note that this is just an outline of the activities, not the project plan, nor the 
Q\&A, nor the Validation plan. The \emph{verification} arrows where not represented on this outline in order 
not to clutter the drawing. Also note that the activities needed for the toolchain are not
covered here.}

\begin{figure}
  \centering
  \fbox{\includegraphics[scale=0.65]{Process1.png}}
  \caption{Main process}
  \label{fig:main_process}
  \centering
  \fbox{\includegraphics[scale=0.65]{Process2.png}}
  \caption{Safety analyses}
  \label{fig:safety_process}
 \end{figure}

Fig. \ref{fig:main_process} shows the main part of the development process. This process may be seen
as a ``double-V''. The smaller V corresponds to the development and validation of the high level model. 

It starts by the SRS which is not part of the project (SUBSET-026), then outlines the boundaries and 
the applicable requirements from the SUBSET-026 that will be used in the model. This outline 
is provided in the Subsystem Requirement Specification (SSRS). This document describe the subsystem that 
will be modelled. It describes the architecture of the subsystem (functions and their I/O) and the 
requirements allocated to these functions. If necessary, the requirements are rewritten in order to 
address the I/O and to correspond to the allocation. This document also provide the Vital/Non Vital 
classification of the requirements and data stream. The architecture part is described in a 
semi-formal language, and the requirements are described in natural language.

The next step is the creation of the model itself, from the SSRS. Because this model is executable, 
it can be validated as itself, thus the first ``closing branch'' of the V. This model will be 
semi-formal, and aim to cover the full SSRS requirements. This semi-formal model will be sidekicked with 
a formal model for some of the functions of the model.

The first ``closing branch'' corresponds to the validation of the subsystem, using the semi-formal model
(with tests) and the formal model (with proof).

The second ``closing branch'' corresponds to the production of real time code capable of running on an 
onboard computer. This code shall be derived from the semi-formal model (possibly with an intermediate
SW model between). There are two possibilities for the generation of code:
\begin{itemize}
\item a SIL0 \emph{demonstrator} or \emph{simulator},
\item a SIL4 implementation of the model.
\end{itemize}

The SIL0 demonstrator is a deliverable of the project openETCS. On the other hand, the project toolchain and 
methodology shall be compatible with the generation of a SIL4 software, but the generation of this SW 
and the generator used for this generation are \emph{not} part of the project.

The yellow boxes correspond to activities that should be covered completely in order to produce 
a certifiable product, but of which only a subset will be conducted in order to demonstrate the 
capabilities of the product. We consider that doing the full set of activities for the project to 
be fully compliant to CENELEC standards (\emph{i.e.} to be certifiable) is a huge task. Hence we 
should isolate a subset of this tasks, as complete in terms of tasks as possible in order to be 
convinced of the feasibility of the whole activities. 

Therefore we have to discriminate three kinds of tasks:
\begin{description}
\item[blue:] the tasks that will be completely achieved in the scope of the OpenETCS project;
\item[red:] the tasks that will be not be achieved, because they are out of the scope of the OpenETCS project;
\item[yellow:] the tasks for which a sample will be achieved, because they are in the scope of the 
OpenETCS but doing them completely is unrealistic considering the resources of the project.
\end{description}


Fig. \ref{fig:safety_process} shows activities that are needed for the safety analyses. It should 
be considered in parallel of the descending branch of the V, but has been put on a separate diagram for
the sake of clarity. These activities will be conducted on a subset of the model.
The validation tasks corresponds to the safety validation of the model w.r.t. 
the safety properties.

A subset of high level safety properties are provided, 
which must be refined side-to-side with each step on the 
descending branch of the V. These properties are then used for the safety analysis of the model subset.

\section{Requirements}
\subsection{Runtime Model \& API}
The framework needs to provide a list of properties and functions. If we take the parallel of the Java environment, 
some of these properties/functions will be provided by the \emph{abstract machine} properties, and some of them will 
be provided by the API.

If we consider for example ``allocation of memory'', in Java usually it is just provided by the creation of an object 
(thus in the ``Runtime model''). In C it is given by the \emph{malloc} function, which is part of the API (of course, 
we will find eventually that it leads to the runtime model too, but in the user point of view, it is
definitely part of the API).

What I consider is that at requirement level, we do not want to know which property will come from API and which will 
come from the runtime model. We are only interested in the properties themselves.

In order to avoid ambiguities, we will define the following.
\begin{description}
\item[Runtime model.] This is the abstract layer required to ``run'' the formal model. It shall provide
in the formalism part or all of the following (but not restricted to):
\begin{itemize}
\item memory management,
\item execution of state machines (or of the chosen formal objects), 
\item failures, 
\item communication between processes and concurrence,
\item \emph{real time} clock.
\end{itemize}
All these can be provided with or without safety properties. This corresponds in fact to the services 
provided by the ``abstract machine(s)'' which runs the models.
\item[API.]
 This is the functions/primitives required to complete the \emph{Runtime model}. It shall provide
the remaining of the features listed hereabove which are not provided by the Runtime model.

All these can be provided with or without safety properties.
\item[RTM/API.]
This corresponds to the Runtime Model \emph{plus} API. Therefore it should provide all the services
needed to emulate at abstract level the hardware platform that could run the software.
\item[Functional Architecture.] This corresponds to the functional boundaries between the ETCS KERNEL 
and the other functional components (JRU, DMI, Odometry, Eurobalise, Euroradio\dots). These boundaries
are described in the FIS or FFFIS. It also includes the parting of the KERNEL into different 
functions.
\end{description}

In the following requirements, we will not discriminate what is required from the API and from the 
RTM. This is the definition of these components that will allocate the requirements to the different 
parts. Hence we will only state requirements on the RTM/API.



\req{The RTM/API model shall provide an abstraction layer of the hardware architecture.}
\subreq{The RTM/API shall abstract memory management.}
\subreq{The RTM/API shall abstact the execution of states machine.}
\subreq{The RTM/API shall allow communication and concurrence (if requested by the model formalism).}
\subreq{The RTM/API shall allow read/write to a persistent data store.}
\subreq{The RTM/API shall allow to state \emph{real time} constraints.}
\subreq{The RTM/API shall provide emulation for a \emph{real time} clock.}

\reqfixed{01}{004}{The RTM/API shall make possible to refine the software into final code able to run 
on hardware complying the EN 50129 standard for the requested SIL.}

\reqfixed{01}{005}{The RTM/API shall allow discriminating Vital processing, data and I/O from Non Vital processing, data and I/O.}
\reqfixed{01}{006}{The RTM/API shall provide a way of communication between Vital processes and Non Vital processes.}

\begin{justif}
The purpose of these requirements is to be able to discriminate the safety part from the non 
safety part. It should be made possible to have it run on a proprietary architecture with both 
software on the same computer (with for example 2oo3, or coded monoprocessor) or on two 
different computers. One way of doing this, for example is to have some critical state 
machines with their data on one side, and the non critical part on the other side, with 
API channels to make them communicate.
\end{justif}

\reqfixed{01}{007}{The RTM/API shall allow fault injection.}
\reqfixed{01}{008}{The RTM/API shall allow logging and tracing.}
\reqfixed{01}{009}{The RTM/API shall provide a way of reading configuration data (\emph{e.g.} constants,\dots)}

\reqfixed{01}{010}{The RTM/API shall provide an abstraction layer of the communication and interfaces 
with other components.}
\begin{justif}
Even if the FIS or FFFIS requires a specific protocol (\emph{e.g.} Profibus), this protocol will not 
be implemented in the high level model. It will be considered that low level communication issues are
taken into account (= emulated) by the RTM/API.
\end{justif}



\subsection{System and Architecture}
\req{The reference ETCS baseline shall be modified only by project decision.}

\req{The SRS (SUBSET-026 for the reference baseline) shall be refined into a SSRS.}
\subreq{The SSRS shall identify all functions, interfaces and parameters in addition to the ones covered by the SRS but 
which are requested at functional level in order to be compliant to the SRS.}
\subreq{The SSRS shall provide a functional architecture of the OBU.}
\subsubreq{The SSRS shall split the KERNEL into independent functions.}
\subsubreq{The description of the architecture shall be semi-formal.}
\subsubreq{This architecture shall provide the functions and the data streams between them.}
\subsubreq{The SSRS shall describe which part of this architecture will be modelled.}
\subsubreq{The SSRS shall provide the interfaces between the considered subsystem and its environment.}
\subsubreq{The SSRS shall identify all functions, interfaces and parameters in addition to the ones covered by 
the SRS but which are requested at functional level in order to be compliant to the SRS.}
\subsubreq{When the boundary of the formalized subsystem corresponds to a FIS or FFFIS, the SSRS shall try to comply to it even when it is not mandatory.}

\subreq{The SSRS shall allocate the requirements of the SRS to the functions and their I/O.}
\subreq{The SSRS shall be compliant or shall allow compliance to the mandatory requirements from the other subsets of the TSI.}
\subreq{Full traceability between the SRS and SSRS shall be provided.}
\subsubreq{All interpretations, additions, omissions and design choices during the allocation have to be documented in one log and justified.}
\subsubreq{The requirements allocated to other subsystemes (\emph{e.g.} RBC) shall be tracked.}
\subsubreq{Lower level requirements refined from higher level requirements shall be tracked.}

\subreq{In case of divergence between an identified national behavior and the SRS behavior, it shall be discussed and decided whether or not
the national behaviors are required in the SSRS.}
\subsubreq{If it is the case, it shall be traced explicitly.}
\subsubreq{If it is the case, it shall be possible by configuration to enforce pure compliance to the SRS.}

\req{The SSRS shall identify the Vital and Non Vital functions, requirements, and data streams.}

\subsection{Model(s)}
\req{The subsystem described in the SSRS shall be modelled into a Semi-Formal Model (SFM).}
\subreq{The SFM shall be modelled in a semi-formal means of decription.}
\subreq{The SFM shall be as consistent as possible with the SSRS level of abstraction.}
\subsubreq{All the requirements of the SSRS shall be covered by the SFM.}
\subsubreq{All safety requirements derived from the Hazard Log and allocated to the sub-system functionality shall be covered by the SFM}
\subsubreq{Needed interpretations, additions and omissions shall be tracked and justified.}
\subsubreq{If a deviation is needed, it shall be tracked and justified, and it will also be insulated as much as possible using 
proper modularity.}
\subsubreq{Traceability between the SSRS and the SFM shall be provided.}
\subsubreq{Exported requirements shall be tracked.}
\subsubreq{Lower level functional requirements refined from higher level functional requirements shall be tracked.}
\subsubreq{Lower level safety requirements refined from higher level safety requirements shall be tracked.}

\req{The SFM design and level of description shall be executable.}

\req{Some parts of the subsystem described in the SSRS shall be modelled into a Fully Formal Model (FFM).}
\subreq{The FFM shall be modelled in a strictly formal mean of description\,\footnote{Nevertheless, we will use the 
wording ``Fully Formal Model'' in order to be allowed to use a different abbreviation than for ``Semi-Formal Model''.}.}
\subreq{The FFM shall be modelled based on the SFM.}
\subreq{The SFM shall be designed in order to make possible the modelling and the validation of the FFM.}
\subreq{The transformation of the SFM into the FFM shall be as straightforward and automated as possible\,\footnote{%
Please note that the requirements on the FFM do not forbid a complete automation of the transformation, nor the identity
of the FFM and SFM.}.}

\req{The SFM design shall be modular and extensible.}
\req{The FFM design shall be modular and extensible.}
\subreq{The modular design of the FFM should represent a refinement of the modular SFM design.}

\req{Safety relevant function should be as much as possible insulated from Non Safety relevant functions.}

\subsection{Safety}
\label{safety}
Side to side with the models (SFM and FFM), should lay a set of  
static safety properties on the model. The higher level properties will be provided 
by the SUBSET-088 and SUBSET-091 documents, that we will consider here as a preliminary hazard analysis, 
because it provides us the higher level dread events.

These dread events will be refined during a Sub System Hazard Analysis (SSHA) into events of the abstraction level of the sub system, 
which will be collected in the Hazard Log. For all hazardous events named in the Hazard Log a risk analysis will be performed.
Based on the analyses suitable risk control activities a determined and collected in the Hazard Log. All hazards and their 
control activities are then refined into safety requirements/ properties\,\footnote{The document ``Safety properties for 
OpenETCS through two examples'' provides a proposal on this subject.
\url{https://github.com/openETCS/requirements/tree/master/WorkDocuments/SafetyRequirementsExamples}} which are transferred 
to the respective backlogs for the different models and their verification and validation.
The lower level Safety Properties/Dread Events shall address variables, state and interfaces used in the formal model.

Formal proof would then be used to prove that the OpenETCS model never enter a Dread State, 
as long as the other subsystem (RBC, communication layer\dots) fulfill their own safety properties 
(axiom describing the environment). The exact process shall be described in the Safety Plan.
 


\req{A Safety Case Concept and Safety Plan shall be issued describing the safety activities
for the model according to CENELEC EN~50126, EN~50128 and EN~50129.}
\subreq{All the output documents required by the EN~50126, EN~50128 and EN~50129 for 
each step of the lifecycle shall be described, or their lack of shall be justified.}
\subreq{The safety activities described in this documents shall cover all the steps from the SRS to the SSRS, then to the SFM, 
the FFM and the source code.}

\req{The safety activities shall at least be applied on a sample of the on-board functionalities and the respective safety 
requirements to demonstrated the suitability of the safety plan.}

\req{The safety activities shall aim at a THR compatible with the SUBSET-091.}

\req{The safety analysis shall consider as higher level Dread Events the events named in the SUBSET-091 in respect to the  
 scope of the subsystem.}
\subreq{Those Dread Events shall be refined to SRS and SSRS levels, then to the model level, and allocated to the functions to 
determine hazardous events.}
\subreq{The refinement shall only be done for a sample part of the system.}

\req{The model-level safety requirements shall be written in the same degree of formality as the corresponding model or higher.}


\req{It shall be verified that the SFM, FFM and source code complies with all respective safety requirements:}
\subreq{either by a real-time constraint\,\footnote{This real-time constraint is not guaranteed in the model itself, but can be expressed in the model using the RTM/API.};}
\subreq{using test for the SFM;}
\subreq{using formal proof for the part modelled in the FFM and for the sorce code;}
\subreq{if a safety requirement/property can not be proven, testing covering all reasonable possible events shall be used.}
 

\subsection{Verification and Validation}
The already provided requirements requires a safety plan compliant to the CENELEC EN~50126, 50128 and 50129.
This pulls a number of requirements on V\&V, including Verification and Validation plans. On the topic of 
compliance to EN~50128, one shall also refer to the D2.2 document.


\req{A Verification plan shall be issued and complied with.}
\subreq{The verification plan shall provide a method to demonstrate the requirement covering over all development artifacts.}
\subreq{The verification plan shall state all verification activities from the SUBSET 26 and all other relevant TSI documents to the source code.}
\req{A Validation Plan shall be issued and complied with.}
\subreq{The validation plan shall provide a method to validate all functional and safety requirement over all development artifacts.}
\subreq{The validation plan shall state all validation activities from the SUBSET 26 and all other relevant TSI documents to the source code.}

\reqfixed{01}{021}{The test plan shall comply the mandatory documents of the SUBSET-076, restricted to the scope of 
the OpenETCS project.}
\begin{justif}
It will possibly be difficult to model all the tests in the course of the project, but the test plan should at least 
be complete.
\end{justif}


\subsection{Language and formalism}
\req{The description of the SFM shall be understandable by domain experts without specific training.}
\subreq{The SFM shall provide graphical descriptions for components relations, process sequences and data flows.}
\subreq{Process involving timing and scheduling aspects shall be visually demonstrated.}

\req{The means of discription used to formalize safety properties shall be formal and declarative.}
\subreq{The formalism shall be understandable by domain experts without specific training.}
\subreq{The formalism shall be able to state:}
\subsubreq{constraints,}
\subsubreq{logical relations,}
\subsubreq{timing relations.}

\req{All means of description used shall be standardized or at least documented in detailed.}
\req{The means of descriptions used for SSRS, SFM and FFM modeling shall be open for the use with different tool \emph{via}:}
\subreq{direct exchange of the model data file;}
\subreq{or fully automated translation of the model data file.}
 

\req{The means of description for the SFM shall be able to formalize:}
\subreq{State machines,}
\subreq{Time-outs,}
\subreq{Truth tables,}
\subreq{Arithmetics,}
\subreq{Braking curves,}
\subreq{Logical statements,}
\subreq{Messages and fields.}


\req{The language for the FFM shall be able to formalize as much as possible of:}
\subreq{State machines,}
\subreq{Time-outs,}
\subreq{Truth tables,}
\subreq{Arithmetics,}
\subreq{Braking curves,}
\subreq{Logical statements,}
\subreq{Messages and fields,}
\subreq{Constraints,}
\subreq{Logical relations.}


\begin{comment}
These requirements do not state that all these objects need to be \emph{first order objects} of
the language. They only state that it should be possible to formalize and manipulate them.

It is to be noted that if (for example) braking curves are objects of the language, it shall be
proved that they are sound, and that the code generation for these objects is also sound.
\end{comment}

\req{The mean of description of the SFM shall allow it to be executable.}

\begin{comment}
This requirement is in the section ``language and formalism'' because in order for the model to 
be executable, it has to be able to yield some algorithmic content and determinism (or a way 
of determining a non-deterministic model), which is indeed a property on the formal aspects
of the model. In the other hand, it is also a requirement on the tool chain, hence there are also
some requirements on this topic in Sect.~\ref{toolchain}.
\end{comment}

\req{It shall be possible to assert logical properties on the SFM and FFM (\emph{e.g.} invariants).}
\subreq{It shall be possible to check the conformance of these properties at runtime on the SFM.}
\subreq{It shall be possible to prove the conformance of the FFM to these properties.}

\reqfixed{01}{028}{The language and formalism should be evolutive.}


\subsection{Tools chain}
\label{toolchain}
\subsubsection{Usage}

\req{The tools chain shall be composed as far as possible of Open Source components licensed under a license compatible with the EUPL license.}
\subreq{Closed source components may be used, but only if their use is not mandatory in the process, 
or if an open source counterpart is provided.}
\subreq{If a closed source component is used, it has to be displayed how an open source component has to be designed to replace the closed component later.}

\req{The tools chain shall be portable to common operating systems.}
\subreq{The tool chain shall run stable on all main operating systems.}
\subreq{The tool chain shall run with a good performance on all main operating systems.}

\req{The tools used in the tool chain shall be able to cooperate, \emph{i.e.} the outputs of one 
tool will be suitable to be used as the inputs of another tool.}
\subreq{All possible input and output formats of a tool have to be documented.}
\subreq{Open data formats shall be used for the tool cooperation.}


\reqfixed{01}{032}{If tools are required for configuration management, they will be considered as part of the tool chain.}

\req{The tools chain shall allow to generate executable code from the model(s).}

\subsubsection{Information management}
\req{The tools chain shall be sufficiently robust to allow large software management (at least covering the onboard 
part of the SUBSET-026).}
\subreq{It shall allow modularity at any level (proof, models, software).}
\subreq{It shall allow the management of documentation.}
\subreq{It shall allow distributed software development.}
\subreq{It shall allow simultaneous multi user usage.}
\subreq{It shall include an \emph{issue-tracking system}, in order to allow change management and 
errors/bugs management.}
\subreq{It shall allow to document/track the differences between the models and the ERTMS reference.}
\subreq{It shall support management of subsequent Subset-026 versions, as well as differences tracking between Subset-026 versions.}
\subreq{It shall allow concurrent version development, or be compatible with tools allowing
concurrent version development.}
\subreq{The version management tools shall use model-based version control instead of text-based version control, when appropriate.}
\subreq{In particular it shall allow to track the roles and responsibilities of each  participant on a configuration item, at each step of the project lifecycle.}
\subreq{In particular, version management shall allow to track version of the safety properties 
together with the models.}


\reqfixed{01}{035}{The tool chain shall allow traceability between:}
\subreqfixed{01}{035}{01}{the documentation/requirements and the models,}
\subreqfixed{01}{035}{02}{the documentation/requirements and the tests,}
\subreqfixed{01}{035}{03}{the models and the tests,}
\subreqfixed{01}{035}{04}{the documentation/requirements and the models,}
\subreqfixed{01}{035}{05}{the documentation/requirements and the safety properties/requirements,}
\subreqfixed{01}{035}{06}{the models and the safety properties/requirements,}
\subreqfixed{01}{035}{07}{the tests and the safety properties/requirements.}

\req{The tools chain shall be compliant to EN 50128 for the corresponding tool level.}

\subsubsection{Testing}
\reqfixed{01}{036}{The SFM shall be executable in debug mode (step-by-step), allowing
inspection of states, variables and I/O.}
\reqfixed{01}{037}{The environment shall be emulated by high level construction of the inputs.}
\begin{justif}
``High level'' means that it will not be necessary to define bitwise the inputs at each cycle.
On the contrary, some automation will be available to define the behavior of the inputs.
\end{justif}

\reqfixed{01}{038}{The tool chain shall allow to write, execute and store \emph{test cases} and \emph{use cases}
for the SFM.}
\req{Version management will allow to map test cases version to the SFM, the FFM and source code versions.}
\req{The tool chain shall allow to generate test cases for the SFM, the FFM and source code from a test model.}
\req{The tool chain shall allow to write, execute and store test sequences combining multiple test cases for the SFM, the FFM and source code.}

\subsubsection{Conformance to standards}

\req{Each tool in the tool chain shall be classified among T1, T2 and T3 depending on its usage in the process.}
\reqfixed{01}{042}{The tool chain shall conform to EN~50128 requirements, for the corresponding SIL and tool 
class\,\footnote{Refer in particular to D2.2.}.}
\subreqfixed{01}{042}{01}{For T2 and T3 tools\,\footnote{T2: Tools contributing to the test or verification of the code 
or design 
\emph{e.g.} static analyzers, test generators\dots)\\ T3: tools contributing directly or indirectly
to the final code or data (\emph{e.g.} compilers, code translator\dots)}, the choice of tools shall be 
justified, and the justification shall
include how the tool's failures are covered, avoided or taken into account (ref. to EN 50128 6.7.4.2).}

\subreqfixed{01}{042}{02}{All T2 and T3 tools must be provided with their user manuals.}

\subreqfixed{01}{042}{03}{For all T3 tool, the proof of correctness  or the measure taken to guarantee the correctness 
of the output w.r.t. their specification and the inputs shall be provided.}
\subsubreqfixed{01}{042}{03}{01}{\dots for data transformation,}
\subsubreqfixed{01}{042}{03}{02}{\dots for software transformation (\emph{e.g.} translation, compilation\dots).}

\subsection{Demonstrator}
\req{A demonstrator software will be built from the SFM.}
\req{The demonstrator shall be non vital.}
\req{The demonstrator shall be able to run in real time.}
\req{The demonstrator shall comply to the standardized interfaces in order to be able to interface with other subsystems.}
\req{The demonstrator shall be able to run on a SIL0 onboard computer.}

\docend

\end{document}
%LAST REQ USED = 42 % DO NOT MODIFY THIS LINE